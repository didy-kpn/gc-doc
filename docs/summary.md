# 統合仕様駆動開発ワークフローの設計案

## 1. はじめに

このドキュメントは、「Claude Code Spec Workflow」と「Spec-Kit」という2つの先進的な仕様駆動開発ワークフローを分析し、それぞれの利点を統合した新しいワークフローのアイディアを提案するものです。分析、比較、そして統合案の3部構成となっています。

## 2. 分析：各ワークフローの優れた点

### 2.1. Claude Code Spec Workflow

このワークフローは、AIとの協業を通じて、開発プロセス全体の一貫性と品質を安定させることに長けています。

*   **永続的なコンテキスト管理 (`Steering Documents`)**: プロジェクトの「指針書」として `product.md`（製品ビジョン）、`tech.md`（技術標準）、`structure.md`（構成規則）を定義します。これにより、AIが生成する成果物の一貫性が飛躍的に向上します。
*   **自動品質ゲート (`Validator Agents`)**: 「要求定義」「設計」「タスク分割」の各完了時に、専門のAIエージェントが生成物を自動検証します。これにより、品質を客観的に保証し、手戻りを防ぎます。
*   **軽量なバグ修正フロー**: 大規模な新機能開発とは別に、日常的なバグ修正に特化した軽量なフローが用意されており、実用性が高いです。
*   **AI協業の最適化**: 設計をAIが処理しやすい「アトミック（単一目的）」なタスクに分割することを重視し、コード生成の成功率を高めます。

### 2.2. Spec-Kit

このワークフローは、厳格な開発原則とテスト駆動開発（TDD）をプロセスに組み込むことで、ソフトウェアの品質を根本から高めることに重点を置いています。

*   **「意図」から始める開発 (`Intent-Driven`)**: 開発の始点を「何を(What)」「なぜ(Why)」に置き、技術詳細（How）を後回しにすることで、ビジネス要求と実装の乖離を防ぎます。
*   **厳格なテスト駆動開発 (TDD) の強制**: プロセスレベルでテスト先行を義務付けます。タスクリストでは必ずテスト作成が実装より先に来るように生成され、高品質なコードベースを構築します。
*   **プロジェクト憲法 (`Constitution`) による原則の適用**: プロジェクトが従うべき普遍的な開発原則（例: シンプルさ、TDD徹底）を「憲法」として定義し、設計を自動チェックすることでアーキテクチャの一貫性を保ちます。
*   **体系的な設計ドキュメントの自動生成**: 計画フェーズでデータモデル、API契約、技術調査レポートなどを体系的に生成し、設計の網羅性を高めます。

## 3. 比較：アプローチの違い

| 観点 | Claude Code Spec Workflow | Spec-Kit |
| :--- | :--- | :--- |
| **中核思想** | AIとの協業による**一貫性**と**品質保証** | 開発原則とTDD徹底による**品質文化**の醸成 |
| **コンテキスト管理** | 具体的なルールセット (`Steering Docs`) | 高レベルな原則 (`Constitution`) |
| **品質保証** | 各フェーズ後のAIによる**自動検証** | **TDDのプロセスレベルでの強制** |
| **プロセス** | 柔軟なフェーズ進行と軽量な代替フロー | 厳格で規律あるフェーズ進行 |

**Claude Code Spec Workflow**は「AIアシスタントを優秀なチームメンバーにするための仕組み」に、**Spec-Kit**は「規律ある開発文化をコードとプロセスで強制するための仕組み」に優れていると言えます。

## 4. 提案：統合ワークフロー「Intent-Driven Quality Workflow (IDQW)」

両者の利点を組み合わせ、以下のコンセプトを持つ新しいワークフローを提案します。

**コンセプト**: 「開発者の**意図**を、厳格な**品質プロセス**を通じて、**一貫性**のあるコードへと変換する」

### 4.1. 主な特徴

*   **階層的コンテキスト管理**: `Spec-Kit`の**`Constitution`（原則）**と`Claude`の**`Steering Documents`（指針）**を両方採用。高レベルな原則と具体的なルールの両面からAIの振る舞いを制御します。
*   **TDDの完全なプロセス組込み**: `Spec-Kit`の思想に基づき、テストの先行作成をプロセスに完全に統合し、タスクリストの順序で強制します。
*   **各フェーズにおけるAI自動品質ゲート**: `Claude`の`Validator`の思想を各フェーズに導入。生成された仕様書、設計書、タスクリストをAIが自動レビューし、品質を担保します。
*   **体系的かつ柔軟なドキュメント生成**: `Spec-Kit`のように体系的な設計ドキュメントを基本としつつ、プロジェクトの規模に応じてテンプレートで調整可能とします。
*   **デュアルフローシステム**: `Claude`の思想を取り入れ、厳格な「新機能開発フロー」と、ドキュメント作成を簡略化した「軽量修正フロー」（バグ修正、リファクタリング用）を提供します。

### 4.2. 提案ワークフローのフェーズ

| フェーズ | コマンド (案) | 主な入力 | 主な出力 | 品質ゲート (AIによる自動検証) |
| :--- | :--- | :--- | :--- | :--- |
| 1. **意図定義** | `/specify` | ユーザーのアイデア | `spec.md` | ・要求のテスト可能性<br>・`product.md`との整合性 |
| 2. **設計・計画** | `/plan` | `spec.md` | `plan.md`, `data-model.md`, `contracts/` | ・`Constitution`への準拠<br>・`tech.md`, `structure.md`との整合性 |
| 3. **タスク化** | `/tasks` | `plan.md` | `tasks.md` | ・TDD原則の遵守（テストが先）<br>・タスクのアトミック性 |
| 4. **実装** | `/execute` | `tasks.md` | ソースコード, テスト | ・テストの実行とパス確認 |

### 4.3. 提案するコマンド体系

*   `/spec-init`: プロジェクトの初期セットアップ（`Constitution`と`Steering Docs`のテンプレートを生成）。
*   `/specify <機能説明>`: **意図定義フェーズ**を開始。
*   `/plan <技術指示>`: **設計・計画フェーズ**を開始。
*   `/tasks`: **タスク化フェーズ**を開始。
*   `/execute [task-number]`: タスクを番号で指定して実行。
*   `/fix <問題の説明>`: **軽量修正フロー**を開始。

## 5. 次のステップ

この「Intent-Driven Quality Workflow (IDQW)」のアイディアを基に、より具体的なプロセスの詳細、各ドキュメントのテンプレート、そして各コマンドを実行するAIエージェントのプロンプト設計を進めていきます。